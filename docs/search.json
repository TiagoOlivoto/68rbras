[
  {
    "objectID": "07_pca_cor.html",
    "href": "07_pca_cor.html",
    "title": "07: A paleta genética da linhaça: um mergulho na diversidade de cor auxiliado por métodos multivariados",
    "section": "",
    "text": "library(rio)\nlibrary(tidyverse)\nlibrary(factoextra)\nlibrary(metan)\nlibrary(FactoMineR)\nlibrary(pliman)"
  },
  {
    "objectID": "07_pca_cor.html#exploração",
    "href": "07_pca_cor.html#exploração",
    "title": "07: A paleta genética da linhaça: um mergulho na diversidade de cor auxiliado por métodos multivariados",
    "section": "\n2.1 Exploração",
    "text": "2.1 Exploração\n\ndfplot &lt;- \n  dfbind |&gt; \n  group_by(GEN, tipo) |&gt; \n  summarise(Rm = sum(R * prop),\n            Gm = sum(G * prop),\n            Bm = sum(B * prop),\n            Rv = sd(R) / mean(R),\n            Gv = sd(G) / mean(G),\n            Bv = sd(B) / mean(B))\n\ndfhist_media &lt;- \n  dfplot |&gt; \n  rename(R = Rm, G = Gm, B = Bm) |&gt; \n  select(tipo, R:B) |&gt; \n  pivot_longer(cols = R:B,\n               names_to = \"rgb\",\n               values_to = \"reflectancia\") |&gt; \n  mutate(rgb = fct_relevel(rgb, \"R\", \"G\", \"B\"))\n\n\n# exploração\nggplot(dfhist_media, aes(x = reflectancia, fill = tipo)) +\n  geom_density(alpha = 0.7) +\n  facet_wrap(~rgb) +\n  theme_minimal() +\n  theme(panel.grid.minor = element_blank(),\n        legend.position = \"bottom\")\n\n\n\n\nggsave(\"figs/density.jpg\",\n       height = 3,\n       width = 8)"
  },
  {
    "objectID": "07_pca_cor.html#pca",
    "href": "07_pca_cor.html#pca",
    "title": "07: A paleta genética da linhaça: um mergulho na diversidade de cor auxiliado por métodos multivariados",
    "section": "\n2.2 PCA",
    "text": "2.2 PCA\n\n\ndfpca &lt;- \n  dfplot |&gt; \n  rename(R = Rm, G = Gm, B = Bm) |&gt; \n  column_to_rownames(\"GEN\") |&gt; \n  mutate(BI = sqrt((R^2 + G^2 + B^2) / 3),\n         SCI = (R - G) / (R + G),\n         NGRDI = (G-R)/(G+R),\n         HUE = atan(2*(B-G-R)/30.5*(G-R)),\n         RI = (R^2 / (B * G^3)),\n         .after = tipo)\n\npcam &lt;- PCA(dfpca, quali.sup = 1)\n\n\n\n\n\n\n\n\n# Contribution\nfviz_contrib(pcam, \"var\")\n\n\n\nggsave(\"figs/biplot_cor_contrib.jpg\",\n       height = 6,\n       width = 7)\n\nfviz_pca_biplot(pcam,\n                labelsize = 3,\n                # repel = TRUE,\n                addEllipses = TRUE,\n                habillage = 1)\n\n\n\nggsave(\"figs/biplot_cor.jpg\",\n       height = 6,\n       width = 7)"
  },
  {
    "objectID": "05_pcv.html",
    "href": "05_pcv.html",
    "title": "01: Model grain",
    "section": "",
    "text": "To reproduce the examples of this material, the R packages the following packages are needed.\n\nlibrary(rio)\nlibrary(tidyverse)\nlibrary(factoextra)\nlibrary(caret)\nlibrary(pliman)\nlibrary(metan)"
  },
  {
    "objectID": "05_pcv.html#impacto-da-resolução",
    "href": "05_pcv.html#impacto-da-resolução",
    "title": "01: Model grain",
    "section": "\n6.1 Impacto da resolução",
    "text": "6.1 Impacto da resolução\n\n\nres &lt;- c(50, 100, 150, 200)\nimg &lt;- image_import(\"imgs/pcv/E10_1487.jpg\")\nimg &lt;- image_import(\"imgs/pcv/E5_1200.jpg\")\n\nplot(img)\npcv_h &lt;- \n  sapply(1:length(res), function(x){\n    imgt &lt;- img |&gt; image_resize(rel_size = res[x])\n    cont &lt;- object_contour(imgt, \n                           index = \"B\",\n                           watershed = FALSE,\n                           plot = FALSE)\n    print(nrow(imgt))\n    data.frame(pcv = poly_pcv(cont[[1]]),\n               npp = nrow(cont[[1]]),\n               perim = poly_perimeter(cont[[1]]))\n  })\n\nt(pcv_h)"
  },
  {
    "objectID": "05_pcv.html#compute-the-pcv-and-other-shape-features",
    "href": "05_pcv.html#compute-the-pcv-and-other-shape-features",
    "title": "01: Model grain",
    "section": "\n7.1 Compute the PCV and other shape features",
    "text": "7.1 Compute the PCV and other shape features\n\nres &lt;- \n  analyze_objects(pattern = \"E\",\n                  index = \"B\",\n                  dir_original = \"imgs/flavia\",\n                  watershed = FALSE,\n                  fill_hull = TRUE,\n                  parallel = TRUE,\n                  workers = 4,\n                  pcv_niter = 500,\n                  pcv = TRUE)\nmeas &lt;- get_measures(res)$results |&gt; separate_col(img, into = c(\"specie\", \"img\"))\nexport(meas, \"data/pcv.csv\")"
  },
  {
    "objectID": "05_pcv.html#random-forest",
    "href": "05_pcv.html#random-forest",
    "title": "01: Model grain",
    "section": "\n7.2 Random Forest",
    "text": "7.2 Random Forest\n\n7.2.1 With PCV\n\ndf_pcv &lt;- \n  import(\"data/pcv.csv\") |&gt; \n  select(specie, form_factor, asp_ratio, elongation, pcv)\n\n# best model\ncontrol &lt;-\n  trainControl(method = 'cv',\n               p = 0.7,\n               number = 10,\n               verboseIter = TRUE)\n\nfitpcv &lt;- train(specie ~ .,\n                data = df_pcv,\n                method = 'rf',\n                tuneGrid = expand.grid(.mtry = 7),\n                trControl = control,\n                ntree = 300)\n## + Fold01: mtry=7 \n## - Fold01: mtry=7 \n## + Fold02: mtry=7 \n## - Fold02: mtry=7 \n## + Fold03: mtry=7 \n## - Fold03: mtry=7 \n## + Fold04: mtry=7 \n## - Fold04: mtry=7 \n## + Fold05: mtry=7 \n## - Fold05: mtry=7 \n## + Fold06: mtry=7 \n## - Fold06: mtry=7 \n## + Fold07: mtry=7 \n## - Fold07: mtry=7 \n## + Fold08: mtry=7 \n## - Fold08: mtry=7 \n## + Fold09: mtry=7 \n## - Fold09: mtry=7 \n## + Fold10: mtry=7 \n## - Fold10: mtry=7 \n## Aggregating results\n## Fitting final model on full training set\nprint(fitpcv)\n## Random Forest \n## \n## 1907 samples\n##    4 predictor\n##   32 classes: 'E1', 'E10', 'E11', 'E12', 'E14', 'E15', 'E16', 'E17', 'E18', 'E19', 'E2', 'E20', 'E21', 'E22', 'E23', 'E24', 'E25', 'E26', 'E27', 'E28', 'E29', 'E3', 'E30', 'E31', 'E32', 'E33', 'E4', 'E5', 'E6', 'E7', 'E8', 'E9' \n## \n## No pre-processing\n## Resampling: Cross-Validated (10 fold) \n## Summary of sample sizes: 1716, 1717, 1719, 1719, 1714, 1716, ... \n## Resampling results:\n## \n##   Accuracy   Kappa    \n##   0.8065346  0.8001796\n## \n## Tuning parameter 'mtry' was held constant at a value of 7\ncm_pcv &lt;- confusionMatrix.train(fitpcv, norm = \"none\")\n\nstats_pcv &lt;-\n  confusionMatrix(cm_pcv$table)$byClass |&gt; \n  as.data.frame() |&gt; \n  rownames_to_column(\"specie\") |&gt; \n  mutate(specie = str_remove(specie, \"Class: \"),\n         type = \"Com PCV\")\n\ncmcom &lt;- \nggplot(data.frame(cm_pcv$table), aes(Prediction, Reference, fill = Freq)) +\n  geom_tile() +\n  labs(x = NULL,\n       y = NULL) +\n  scale_x_discrete(expand = expansion(0)) +\n  scale_y_discrete(expand = expansion(0)) +\n  scale_fill_gradient2() +\n  geom_text(aes(label = Freq),\n            size = 2) +\n  theme(panel.border = element_rect(color = \"black\", fill = NA),\n        axis.text = element_text( size = 7),\n        axis.text.x = element_text(angle = 90, vjust = 0.5,\n                                   hjust = 1))\n\n\n7.2.2 Without PCV\n\ndf &lt;- \n  import(\"data/pcv.csv\") |&gt; \n  select(specie, form_factor, asp_ratio, elongation)\n\n# best model\ncontrol &lt;-\n  trainControl(method = 'cv',\n               p = 0.7,\n               number = 10,\n               verboseIter = TRUE)\n\nfit &lt;- train(specie ~ .,\n             data = df,\n             method = 'rf',\n             tuneGrid = expand.grid(.mtry = 7),\n             trControl = control,\n             ntree = 300)\n## + Fold01: mtry=7 \n## - Fold01: mtry=7 \n## + Fold02: mtry=7 \n## - Fold02: mtry=7 \n## + Fold03: mtry=7 \n## - Fold03: mtry=7 \n## + Fold04: mtry=7 \n## - Fold04: mtry=7 \n## + Fold05: mtry=7 \n## - Fold05: mtry=7 \n## + Fold06: mtry=7 \n## - Fold06: mtry=7 \n## + Fold07: mtry=7 \n## - Fold07: mtry=7 \n## + Fold08: mtry=7 \n## - Fold08: mtry=7 \n## + Fold09: mtry=7 \n## - Fold09: mtry=7 \n## + Fold10: mtry=7 \n## - Fold10: mtry=7 \n## Aggregating results\n## Fitting final model on full training set\n\nprint(fit)\n## Random Forest \n## \n## 1907 samples\n##    3 predictor\n##   32 classes: 'E1', 'E10', 'E11', 'E12', 'E14', 'E15', 'E16', 'E17', 'E18', 'E19', 'E2', 'E20', 'E21', 'E22', 'E23', 'E24', 'E25', 'E26', 'E27', 'E28', 'E29', 'E3', 'E30', 'E31', 'E32', 'E33', 'E4', 'E5', 'E6', 'E7', 'E8', 'E9' \n## \n## No pre-processing\n## Resampling: Cross-Validated (10 fold) \n## Summary of sample sizes: 1714, 1717, 1715, 1714, 1717, 1715, ... \n## Resampling results:\n## \n##   Accuracy   Kappa    \n##   0.6565264  0.6452642\n## \n## Tuning parameter 'mtry' was held constant at a value of 7\ncm &lt;- confusionMatrix.train(fit, norm = \"none\")\nstats &lt;-\n  confusionMatrix(cm$table)$byClass |&gt; \n  as.data.frame() |&gt; \n  rownames_to_column(\"specie\") |&gt; \n  mutate(specie = str_remove(specie, \"Class: \"),\n         type = \"Sem PCV\")\n\ncmsem &lt;- \nggplot(data.frame(cm$table), aes(Prediction, Reference, fill = Freq)) +\n  geom_tile() +\n  labs(x = NULL,\n       y = NULL) +\n  scale_x_discrete(expand = expansion(0)) +\n  scale_y_discrete(expand = expansion(0)) +\n  scale_fill_gradient2() +\n  geom_text(aes(label = Freq),\n            size = 2) +\n  theme(panel.border = element_rect(color = \"black\", fill = NA),\n        axis.text = element_text( size = 7),\n        axis.text.x = element_text(angle = 90, vjust = 0.5,\n                                   hjust = 1))\n\narrange_ggplot(cmsem, cmcom, ncol = 1)\n\n\n\n\nggsave(\"figs/cm_com.jpg\",\n       width = 5,\n       height = 6)"
  },
  {
    "objectID": "03_pca.html",
    "href": "03_pca.html",
    "title": "03: Análise de Componentes Principais para Caracterização e Priorização de Variáveis em Genótipos de Linho (Linum usitatissimum, L.)",
    "section": "",
    "text": "1 Pacotes\n\nlibrary(rio)\nlibrary(tidyverse)\nlibrary(factoextra)\nlibrary(FactoMineR)\nlibrary(caret)\nlibrary(metan)\nlibrary(ggridges)\n\n\n2 PCA\n\ndf &lt;- \n  import(\"data/data_pca.xlsx\") |&gt; \n  mutate(IC = MG / MC) |&gt; \n  column_to_rownames(\"GEN\")\n\n# AP altura de planta (cm)\n# AC altura de cápsula (cm)\n# NR numero de ramificações\n# MC massa de cápsula (g) \n# MG massa de grãos (g)\n# NC numero de capsulas\n# NG numero de graos\n# DC diametro de capsula\n# LG largura de grao\n# CG comprimento de grao\n\n\n3 Correlação\n\ncorr &lt;- corr_coef(df)\nnetwork_plot(corr)\n\n\n\nggsave(\"figs/correl_pca.jpg\")\n\n\n4 PCA\n\npca &lt;- PCA(df,  quali.sup = 1)\n\n\n\n\n\n\n\nfviz_contrib(pca, \"var\", axes = 1:2)\n\n\n\n\nfviz_pca_biplot(pca, \n                repel = TRUE,\n                habillage = 1)\n\n\n\n\nggsave(\"figs/biplot.jpg\")\n\n\n5 Distribution\n\ndfp &lt;- \n  df |&gt; \n  select(TIPO, NC, NG, CG, LG, IC) |&gt; \n  pivot_longer(-TIPO)\nggplot(dfp, aes(value, y = TIPO, fill = TIPO)) +\n  geom_density_ridges(alpha = 0.8) +\n  facet_wrap(~name, scales = \"free\") +\n  labs(x = \"Valor observado\",\n       y = \"Tipo de linhaça\",\n       fill = \"\") +\n  theme(legend.position = \"bottom\",\n        panel.grid.minor = element_blank())\n\n\n\nggsave(\"figs/density_biplot.jpg\")\n\n\n6 Section info\n\nsessionInfo()\n## R version 4.3.3 (2024-02-29 ucrt)\n## Platform: x86_64-w64-mingw32/x64 (64-bit)\n## Running under: Windows 11 x64 (build 22631)\n## \n## Matrix products: default\n## \n## \n## locale:\n## [1] LC_COLLATE=Portuguese_Brazil.utf8  LC_CTYPE=Portuguese_Brazil.utf8   \n## [3] LC_MONETARY=Portuguese_Brazil.utf8 LC_NUMERIC=C                      \n## [5] LC_TIME=Portuguese_Brazil.utf8    \n## \n## time zone: America/Sao_Paulo\n## tzcode source: internal\n## \n## attached base packages:\n## [1] stats     graphics  grDevices utils     datasets  methods   base     \n## \n## other attached packages:\n##  [1] ggridges_0.5.6   metan_1.18.0     caret_6.0-94     lattice_0.22-5  \n##  [5] FactoMineR_2.11  factoextra_1.0.7 lubridate_1.9.3  forcats_1.0.0   \n##  [9] stringr_1.5.1    dplyr_1.1.4      purrr_1.0.2      readr_2.1.5     \n## [13] tidyr_1.3.1      tibble_3.2.1     ggplot2_3.5.0    tidyverse_2.0.0 \n## [17] rio_1.0.1       \n## \n## loaded via a namespace (and not attached):\n##   [1] mathjaxr_1.6-0       RColorBrewer_1.1-3   rstudioapi_0.16.0   \n##   [4] jsonlite_1.8.8       magrittr_2.0.3       TH.data_1.1-2       \n##   [7] estimability_1.5     farver_2.1.1         nloptr_2.0.3        \n##  [10] rmarkdown_2.26       ragg_1.3.0           vctrs_0.6.5         \n##  [13] minqa_1.2.6          rstatix_0.7.2        htmltools_0.5.8     \n##  [16] broom_1.0.5          cellranger_1.1.0     pROC_1.18.5         \n##  [19] parallelly_1.37.1    htmlwidgets_1.6.4    plyr_1.8.9          \n##  [22] sandwich_3.1-0       emmeans_1.10.1       zoo_1.8-12          \n##  [25] lifecycle_1.0.4      iterators_1.0.14     pkgconfig_2.0.3     \n##  [28] Matrix_1.6-5         R6_2.5.1             fastmap_1.1.1       \n##  [31] future_1.33.2        digest_0.6.35        numDeriv_2016.8-1.1 \n##  [34] colorspace_2.1-0     GGally_2.2.1         patchwork_1.2.0     \n##  [37] textshaping_0.3.7    ggpubr_0.6.0         labeling_0.4.3      \n##  [40] fansi_1.0.6          timechange_0.3.0     abind_1.4-5         \n##  [43] polyclip_1.10-6      compiler_4.3.3       withr_3.0.0         \n##  [46] backports_1.4.1      carData_3.0-5        ggstats_0.6.0       \n##  [49] ggforce_0.4.2        R.utils_2.12.3       ggsignif_0.6.4      \n##  [52] MASS_7.3-60.0.1      lava_1.8.0           scatterplot3d_0.3-44\n##  [55] flashClust_1.01-2    ModelMetrics_1.2.2.2 tools_4.3.3         \n##  [58] future.apply_1.11.2  nnet_7.3-19          R.oo_1.26.0         \n##  [61] glue_1.7.0           nlme_3.1-164         grid_4.3.3          \n##  [64] cluster_2.1.6        reshape2_1.4.4       generics_0.1.3      \n##  [67] recipes_1.0.10       gtable_0.3.5         tzdb_0.4.0          \n##  [70] R.methodsS3_1.8.2    class_7.3-22         data.table_1.15.4   \n##  [73] hms_1.1.3            car_3.1-2            utf8_1.2.4          \n##  [76] ggrepel_0.9.5        foreach_1.5.2        pillar_1.9.0        \n##  [79] splines_4.3.3        tweenr_2.0.3         survival_3.5-8      \n##  [82] tidyselect_1.2.1     knitr_1.46           stats4_4.3.3        \n##  [85] xfun_0.43            hardhat_1.3.1        timeDate_4032.109   \n##  [88] DT_0.33              stringi_1.8.3        yaml_2.3.8          \n##  [91] boot_1.3-29          evaluate_0.23        codetools_0.2-19    \n##  [94] multcompView_0.1-10  cli_3.6.1            rpart_4.1.23        \n##  [97] xtable_1.8-4         systemfonts_1.0.6    munsell_0.5.1       \n## [100] Rcpp_1.0.12          readxl_1.4.3         globals_0.16.3      \n## [103] coda_0.19-4.1        parallel_4.3.3       leaps_3.1           \n## [106] gower_1.0.1          lme4_1.1-35.2        listenv_0.9.1       \n## [109] mvtnorm_1.2-4        ipred_0.9-14         lmerTest_3.1-3      \n## [112] scales_1.3.0         prodlim_2023.08.28   rlang_1.1.3         \n## [115] multcomp_1.4-25"
  },
  {
    "objectID": "01_diversidade.html",
    "href": "01_diversidade.html",
    "title": "01: Diversidade genética em genótipos de linho (Linum usitatissimum, L.) cultivados em Florianópolis-SC",
    "section": "",
    "text": "library(rio)\nlibrary(tidyverse)\nlibrary(factoextra)\nlibrary(caret)\nlibrary(metan)\nlibrary(DescTools)\nlibrary(pliman)"
  },
  {
    "objectID": "01_diversidade.html#distâncias",
    "href": "01_diversidade.html#distâncias",
    "title": "01: Diversidade genética em genótipos de linho (Linum usitatissimum, L.) cultivados em Florianópolis-SC",
    "section": "\n6.1 Distâncias",
    "text": "6.1 Distâncias\n\ndourada &lt;- \n  dfan |&gt; \n  filter(TIPO == \"DOURADA\") |&gt; \n  select(-c(INDIVIDUO, ROW, COL, PLOT, TIPO)) |&gt; \n  column_to_rownames(\"GEN\")\n\ndist_dourada &lt;- metan::clustering(dourada, nclust = 3)\n\ndenddo &lt;- fviz_dend(dist_dourada$hc, k = 3)\n\n\narrange_ggplot(denddo, dendma,\n               ncol = 1,\n               tag_levels = \"a\")\n\n\n\n\nggsave(\"figs/dendrograma.jpg\",\n       height = 6.5,\n       width = 7)"
  },
  {
    "objectID": "01_diversidade.html#médias",
    "href": "01_diversidade.html#médias",
    "title": "01: Diversidade genética em genótipos de linho (Linum usitatissimum, L.) cultivados em Florianópolis-SC",
    "section": "\n6.2 Médias",
    "text": "6.2 Médias\n\ndfplot &lt;- \n  bind_rows(\n    dist_dourada$data |&gt; mutate(tipo = \"Dourada\"),\n    dist_marrom$data |&gt; mutate(tipo = \"Marrom\")\n  ) |&gt; \n  rownames_to_column(\"Genótipo\") |&gt; \n  metan::as_factor(groups)\n\nmg &lt;-\nggplot(dfplot, aes(groups, MG, fill = groups)) +\n  geom_boxplot() +\n  facet_wrap(~tipo) +\n  labs(x = \"Clusters\",\n       y = \"Massa de grãos por planta (g)\",\n       fill = \"Clusters\")+\n  scale_fill_manual(values =c(\"#619CFF\", \"#00BA38\", \"#F8766D\"))\n\nnc &lt;- \n  ggplot(dfplot, aes(groups, n_Cápsulas, fill = groups)) +\n  geom_boxplot() +\n  facet_wrap(~tipo) +\n  labs(x = \"Clusters\",\n       y = \"Número de cápsulas por planta\",\n       fill = \"Clusters\")+\n  scale_fill_manual(values =c(\"#619CFF\", \"#00BA38\", \"#F8766D\"))\n\nap &lt;- \n  ggplot(dfplot, aes(groups, AP, fill = groups)) +\n  geom_boxplot() +\n  facet_wrap(~tipo) +\n  labs(x = \"Clusters\",\n       y = \"Altura de planta (cm)\",\n       fill = \"Clusters\")+\n  scale_fill_manual(values =c(\"#619CFF\", \"#00BA38\", \"#F8766D\"))\n\narrange_ggplot(mg, nc, ap, \n               tag_levels = \"a\",\n               guides = \"collect\")\n\n\n\nggsave(\"figs/medias_divergencia.jpg\",\n       width = 6,\n       height = 4)\n# correlação\ncorr_plot(dfplot, MG, AP, n_Cápsulas, \n          col.by = tipo)\n\n\n\nggsave(\"figs/correlacao_divergencia.jpg\",\n       width = 6,\n       height = 4)"
  },
  {
    "objectID": "00_about.html",
    "href": "00_about.html",
    "title": "",
    "section": "",
    "text": "Code\nSobre este material\nNeste website você pode encontrar os dados e scripts utilizados nas análises dos seguintes trabalhos apresentados na 68\\(^a\\) Reunião Anual da Região Brasileira da Sociedade Internacional de Biometria (RBras)\nComo reproduzir?\n\nFaça o Download dos dados do repositório github;\nAbra o projeto 68rbras.Rproj no RStudio;\nOpcionalmente, altere funções e argumentos;\nRe-knit o documento para ver os resultados.\nLicença\nEste conteúdo está licenciado com uma Licença Creative Commons - Atribuição-NãoComercial-CompartilhaIgual 4.0 Internacional. O resumo legível da licença afirma que você tem o direito de:\n\nCompartilhar — copie e redistribua o material em qualquer meio ou formato.\nAdaptar — remixar, transformar e construir sobre o material\nAtribuir — Você deve dar o crédito apropriado, fornecer um link para a licença e indicar se foram feitas alterações. Você deve fazê-lo sob quaisquer circunstâncias razoáveis, mas de forma alguma sugerindo que o licenciante endossa você ou seu uso.\n\nEsta licença e válida sob os seguintes termos:\n\n\nNão comercial (NC) — Você não pode usar o material para fins comerciais.\n\nShare Alike (SA) — Se você remixar, transformar ou desenvolver o material, deverá distribuir suas contribuições sob a mesma licença do original.\n\nSem restrições adicionais — Você não pode aplicar termos legais ou medidas tecnológicas que restrinjam legalmente outras pessoas de fazer qualquer coisa que a licença permita.\nSelo DC\n\nO selo selo Democratizando Conhecimento (DC) é uma ideia criada pelo Prof. Ben Dêivid. O selo é compatível com a licença Creative Commons CC BY NC SA 4.0 e é utilizado aqui para garantir que o acesso de todo esse material seja livre, gratuíto e de código aberto.\nVisite-nos!"
  },
  {
    "objectID": "02_rf_especies.html",
    "href": "02_rf_especies.html",
    "title": "02: Identificação de espécies de plantas por análise de imagens: uma abordagem com Random Forest e características de forma e cor",
    "section": "",
    "text": "library(rio)\nlibrary(tidyverse)\nlibrary(performance)\nlibrary(caret)\nlibrary(metan)\nlibrary(pliman)"
  },
  {
    "objectID": "02_rf_especies.html#cenário-1",
    "href": "02_rf_especies.html#cenário-1",
    "title": "02: Identificação de espécies de plantas por análise de imagens: uma abordagem com Random Forest e características de forma e cor",
    "section": "\n3.1 Cenário 1",
    "text": "3.1 Cenário 1\n\ndf &lt;- import(\"data/flavia_rf.csv\")\n\n# cenário 1\n# sem escalas - somente com fatores de forma\nc1 &lt;-\n  df |&gt;\n  select(-c(B1, C1)) |&gt; \n  dplyr::select(specie,\n                # area, perimeter, radius_sd, major_axis, minor_axis,  # scale-dependent\n                eccentricity, solidity, elongation, circularity_norm, form_factor, narrow_factor,     # shape\n                # asm:f13, # texture\n                # DGCI, # color\n                # A2:D10,\n                # pcv,\n                # prop_veins\n  )\n\n# best model\ncontrol &lt;-\n  trainControl(method = 'cv',\n               p = 0.7,\n               number = 10,\n               verboseIter = TRUE)\nfit1 &lt;- train(specie ~ .,\n             data = c1,\n             method = 'rf',\n             tuneGrid = expand.grid(.mtry = 7),\n             trControl = control,\n             ntree = 300)\n## + Fold01: mtry=7 \n## - Fold01: mtry=7 \n## + Fold02: mtry=7 \n## - Fold02: mtry=7 \n## + Fold03: mtry=7 \n## - Fold03: mtry=7 \n## + Fold04: mtry=7 \n## - Fold04: mtry=7 \n## + Fold05: mtry=7 \n## - Fold05: mtry=7 \n## + Fold06: mtry=7 \n## - Fold06: mtry=7 \n## + Fold07: mtry=7 \n## - Fold07: mtry=7 \n## + Fold08: mtry=7 \n## - Fold08: mtry=7 \n## + Fold09: mtry=7 \n## - Fold09: mtry=7 \n## + Fold10: mtry=7 \n## - Fold10: mtry=7 \n## Aggregating results\n## Fitting final model on full training set\n\n# trocar para os outros cenários\nprint(fit1)\n## Random Forest \n## \n## 1907 samples\n##    6 predictor\n##   32 classes: 'E1', 'E10', 'E11', 'E12', 'E14', 'E15', 'E16', 'E17', 'E18', 'E19', 'E2', 'E20', 'E21', 'E22', 'E23', 'E24', 'E25', 'E26', 'E27', 'E28', 'E29', 'E3', 'E30', 'E31', 'E32', 'E33', 'E4', 'E5', 'E6', 'E7', 'E8', 'E9' \n## \n## No pre-processing\n## Resampling: Cross-Validated (10 fold) \n## Summary of sample sizes: 1720, 1715, 1721, 1712, 1717, 1719, ... \n## Resampling results:\n## \n##   Accuracy   Kappa    \n##   0.8163229  0.8103049\n## \n## Tuning parameter 'mtry' was held constant at a value of 7\ncm1 &lt;- confusionMatrix.train(fit1, norm = \"none\")\nstatsc1 &lt;- confusionMatrix(cm1$table)\nstats_by_specie_c1 &lt;- \n  statsc1$byClass |&gt; \n  data.frame() |&gt; \n  select(Precision, Recall, F1, Balanced.Accuracy) |&gt; \n  desc_stat(stats = c(\"min, mean, max\")) |&gt; \n  mutate(cenário = \"C1\")"
  },
  {
    "objectID": "04_MGIDI.html",
    "href": "04_MGIDI.html",
    "title": "04: MGIDI para seleção de genótipos de Linum usitatissimum no melhoramento genético vegetal",
    "section": "",
    "text": "1 Pacotes\n\nlibrary(rio)\nlibrary(tidyverse)\nlibrary(factoextra)\nlibrary(metan)\nlibrary(DescTools)\nlibrary(pliman)\n\n\n2 Dados\n\ndf &lt;- \n  import(\"data/dados_capsulas.xlsx\") |&gt; \n  remove_rows_na() |&gt; \n  mean_by(GEN)\n\n\n3 MGIDI\n\nmgidi_mod &lt;- mgidi(df,\n                   ideotype = c(\"h, h, h, h, 70, 50, 5, h, h\"),\n                   weights = c(3, 1, 1, 1, 2, 2, 2, 5, 5),\n                   SI = 20)\n## \n## -------------------------------------------------------------------------------\n## Principal Component Analysis\n## -------------------------------------------------------------------------------\n## # A tibble: 9 × 4\n##   PC    Eigenvalues `Variance (%)` `Cum. variance (%)`\n##   &lt;chr&gt;       &lt;dbl&gt;          &lt;dbl&gt;               &lt;dbl&gt;\n## 1 PC1          2.95          32.8                 32.8\n## 2 PC2          2.77          30.8                 63.6\n## 3 PC3          1.67          18.5                 82.1\n## 4 PC4          0.73           8.08                90.2\n## 5 PC5          0.42           4.64                94.8\n## 6 PC6          0.33           3.67                98.5\n## 7 PC7          0.12           1.3                 99.8\n## 8 PC8          0.01           0.12                99.9\n## 9 PC9          0.01           0.08               100  \n## -------------------------------------------------------------------------------\n## Factor Analysis - factorial loadings after rotation-\n## -------------------------------------------------------------------------------\n## # A tibble: 9 × 6\n##   VAR     FA1   FA2   FA3 Communality Uniquenesses\n##   &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;       &lt;dbl&gt;        &lt;dbl&gt;\n## 1 NC     0.93  0.07 -0.04        0.87         0.13\n## 2 DC    -0.04 -0.96 -0.11        0.94         0.06\n## 3 AREAC -0.01 -0.97 -0.11        0.95         0.05\n## 4 PC     0    -0.84 -0.04        0.7          0.3 \n## 5 AP     0.08 -0.14 -0.86        0.77         0.23\n## 6 AC     0.17 -0.07 -0.85        0.76         0.24\n## 7 NR     0.3   0.02  0.62        0.47         0.53\n## 8 MC     0.99 -0.02  0.03        0.98         0.02\n## 9 MG     0.98  0     0           0.97         0.03\n## -------------------------------------------------------------------------------\n## Comunalit Mean: 0.8212334 \n## -------------------------------------------------------------------------------\n## Selection differential \n## -------------------------------------------------------------------------------\n## # A tibble: 9 × 8\n##   VAR   Factor     Xo      Xs        SD SDperc sense     goal\n##   &lt;chr&gt; &lt;chr&gt;   &lt;dbl&gt;   &lt;dbl&gt;     &lt;dbl&gt;  &lt;dbl&gt; &lt;chr&gt;    &lt;dbl&gt;\n## 1 NC    FA1    78.0   147.    69.2      88.6   increase   100\n## 2 MC    FA1     2.73    5.28   2.56     93.7   increase   100\n## 3 MG    FA1     2.00    3.96   1.96     98.4   increase   100\n## 4 DC    FA2     0.573   0.572 -0.00111  -0.193 increase     0\n## 5 AREAC FA2     0.268   0.268  0.000285  0.106 increase   100\n## 6 PC    FA2     2.03    2.01  -0.0153   -0.754 increase     0\n## 7 AP    FA3    85.7    84.6   -1.14     -1.33  decrease   100\n## 8 AC    FA3    53.7    51.0   -2.73     -5.09  decrease   100\n## 9 NR    FA3     3.77    5.04   1.27     33.8   decrease     0\n## ------------------------------------------------------------------------------\n## Selected genotypes\n## -------------------------------------------------------------------------------\n## G5 G223 G56 G71 G3 G1 G218 G145 G54 G158 G216 G228 G48 G88\n## -------------------------------------------------------------------------------\nplot(mgidi_mod, SI = 20)\n\n\n\nggsave(\"figs/mgidi.jpg\",\n       height = 5,\n       width = 5)\n\nexport(list(\n  mgidi = mgidi_mod$MGIDI,\n  dif_sel = mgidi_mod$sel_dif,\n  pca = mgidi_mod$PCA,\n  loadings = mgidi_mod$finish_loadings\n),\n\"data/mgidi.xlsx\"\n)\n\n\n4 Pontos fortes e fracos\n\nplot(mgidi_mod, type = \"contribution\")\n\n\n\n\nmgidi_mod$contri_fac &lt;- \n  mgidi_mod$contri_fac |&gt; \n  mutate(across(contains(\"FA\"), \\(x){x - mean(x)}))\n\n\n5 Correlação\n\ncorr_coef(df) |&gt; \n  network_plot()\n\n\n\n\nggsave(\"figs/network.jpg\")\n\n\n6 Section info\n\nsessionInfo()\n## R version 4.3.3 (2024-02-29 ucrt)\n## Platform: x86_64-w64-mingw32/x64 (64-bit)\n## Running under: Windows 11 x64 (build 22631)\n## \n## Matrix products: default\n## \n## \n## locale:\n## [1] LC_COLLATE=Portuguese_Brazil.utf8  LC_CTYPE=Portuguese_Brazil.utf8   \n## [3] LC_MONETARY=Portuguese_Brazil.utf8 LC_NUMERIC=C                      \n## [5] LC_TIME=Portuguese_Brazil.utf8    \n## \n## time zone: America/Sao_Paulo\n## tzcode source: internal\n## \n## attached base packages:\n## [1] stats     graphics  grDevices utils     datasets  methods   base     \n## \n## other attached packages:\n##  [1] pliman_2.1.0.9000 DescTools_0.99.54 metan_1.18.0      factoextra_1.0.7 \n##  [5] lubridate_1.9.3   forcats_1.0.0     stringr_1.5.1     dplyr_1.1.4      \n##  [9] purrr_1.0.2       readr_2.1.5       tidyr_1.3.1       tibble_3.2.1     \n## [13] ggplot2_3.5.0     tidyverse_2.0.0   rio_1.0.1        \n## \n## loaded via a namespace (and not attached):\n##   [1] mathjaxr_1.6-0       RColorBrewer_1.1-3   rstudioapi_0.16.0   \n##   [4] jsonlite_1.8.8       magrittr_2.0.3       farver_2.1.1        \n##   [7] nloptr_2.0.3         rmarkdown_2.26       ragg_1.3.0          \n##  [10] vctrs_0.6.5          minqa_1.2.6          RCurl_1.98-1.14     \n##  [13] base64enc_0.1-3      terra_1.7-71         htmltools_0.5.8     \n##  [16] raster_3.6-26        cellranger_1.1.0     KernSmooth_2.23-22  \n##  [19] htmlwidgets_1.6.4    plyr_1.8.9           rootSolve_1.8.2.4   \n##  [22] mime_0.12            lifecycle_1.0.4      pkgconfig_2.0.3     \n##  [25] Matrix_1.6-5         R6_2.5.1             fastmap_1.1.1       \n##  [28] shiny_1.8.1.1        digest_0.6.35        Exact_3.2           \n##  [31] numDeriv_2016.8-1.1  colorspace_2.1-0     GGally_2.2.1        \n##  [34] mapview_2.11.2       patchwork_1.2.0      leafem_0.2.3        \n##  [37] textshaping_0.3.7    crosstalk_1.2.1      labeling_0.4.3      \n##  [40] fansi_1.0.6          timechange_0.3.0     httr_1.4.7          \n##  [43] polyclip_1.10-6      abind_1.4-5          compiler_4.3.3      \n##  [46] proxy_0.4-27         withr_3.0.0          tiff_0.1-12         \n##  [49] DBI_1.2.2            ggstats_0.6.0        ggforce_0.4.2       \n##  [52] R.utils_2.12.3       MASS_7.3-60.0.1      leaflet_2.2.2       \n##  [55] classInt_0.4-10      gld_2.6.6            tools_4.3.3         \n##  [58] units_0.8-5          mapedit_0.6.0        httpuv_1.6.15       \n##  [61] R.oo_1.26.0          glue_1.7.0           satellite_1.0.5     \n##  [64] nlme_3.1-164         EBImage_4.42.0       promises_1.2.1      \n##  [67] grid_4.3.3           sf_1.0-16            generics_0.1.3      \n##  [70] gtable_0.3.5         tzdb_0.4.0           R.methodsS3_1.8.2   \n##  [73] class_7.3-22         data.table_1.15.4    lmom_3.0            \n##  [76] hms_1.1.3            sp_2.1-3             utf8_1.2.4          \n##  [79] BiocGenerics_0.46.0  ggrepel_0.9.5        pillar_1.9.0        \n##  [82] later_1.3.2          splines_4.3.3        tweenr_2.0.3        \n##  [85] lattice_0.22-5       tidyselect_1.2.1     locfit_1.5-9.9      \n##  [88] knitr_1.46           stats4_4.3.3         xfun_0.43           \n##  [91] expm_0.999-9         stringi_1.8.3        fftwtools_0.9-11    \n##  [94] yaml_2.3.8           boot_1.3-29          evaluate_0.23       \n##  [97] codetools_0.2-19     cli_3.6.1            xtable_1.8-4        \n## [100] systemfonts_1.0.6    munsell_0.5.1        Rcpp_1.0.12         \n## [103] readxl_1.4.3         png_0.1-8            exactextractr_0.10.0\n## [106] jpeg_0.1-10          bitops_1.0-7         lme4_1.1-35.2       \n## [109] mvtnorm_1.2-4        lmerTest_3.1-3       scales_1.3.0        \n## [112] e1071_1.7-14         writexl_1.5.0        rlang_1.1.3"
  },
  {
    "objectID": "06_prod_qualidade.html",
    "href": "06_prod_qualidade.html",
    "title": "06: A influência da época de semeadura em caracteres agronômicos e nutracêuticos de linho (Linum usitatissimum, L.) cultivados na região litorânea de Santa Catarina",
    "section": "",
    "text": "1 Pacotes\n\nlibrary(rio)\nlibrary(tidyverse)\nlibrary(factoextra)\nlibrary(AgroR)\nlibrary(metan)\n\n\n2 Dados\n\ndf &lt;- import(\"data/prod_quali.xlsx\")\n\n\n3 Ácidos graxos\n\ndf_ggplot &lt;-\n  df |&gt;\n  select(epoca:cultivar, C14_1:C22_6n3) |&gt;\n  pivot_longer(C14_1:C22_6n3) |&gt;\n  mutate(GRUPO = ifelse(value &lt; 1, \"Outro\", name)) |&gt;\n  mean_by(GRUPO, epoca, cultivar)\n\nggplot(df_ggplot, aes(epoca, value)) +\n  geom_col(aes(fill = GRUPO),\n           position = \"fill\",\n           color = \"white\") +\n  facet_wrap(~cultivar) +\n  scale_y_continuous(labels = function(x) paste0(x*100, \"%\")) +\n  theme_bw() +\n  labs(x = \"Época de semeadura\",\n       y = \"Proporção dos áxidos graxos totais\")\n\n\n\n\n\n4 Anova\n\n# numero de graos\nng &lt;- with(df, FAT2DBC(epoca, cultivar, bloco, ng))\n## \n## -----------------------------------------------------------------\n## Normality of errors\n## -----------------------------------------------------------------\n##                          Method Statistic   p.value\n##  Shapiro-Wilk normality test(W) 0.9432007 0.5406139\n## \n## \n## -----------------------------------------------------------------\n## Homogeneity of Variances\n## -----------------------------------------------------------------\n##                               Method Statistic   p.value\n##  Bartlett test(Bartlett's K-squared) 0.8455472 0.8385445\n## \n## \n## -----------------------------------------------------------------\n## Independence from errors\n## -----------------------------------------------------------------\n##                  Method Statistic   p.value\n##  Durbin-Watson test(DW)  1.974784 0.2291704\n## \n## \n## -----------------------------------------------------------------\n## Additional Information\n## -----------------------------------------------------------------\n## \n## CV (%) =  13.87\n## Mean =  135.019\n## Median =  128.1\n## Possible outliers =  No discrepant point\n## \n## -----------------------------------------------------------------\n## Analysis of Variance\n## -----------------------------------------------------------------\n##           Df      Sum Sq     Mean.Sq      F value        Pr(F)\n## F1         1 49952.38766 49952.38766 142.40827534 2.097134e-05\n## F2         1   337.13889   337.13889   0.96114261 3.647604e-01\n## Block      2  4188.41382  2094.20691   5.97033312 3.740572e-02\n## F1 × F2    1    18.90309    18.90309   0.05389044 8.241421e-01\n## Residuals  6  2104.61313   350.76885                          \n## \n## -----------------------------------------------------------------\n## No significant interaction\n## -----------------------------------------------------------------\n## \n## -----------------------------------------------------------------\n## F1\n## -----------------------------------------------------------------\n## Multiple Comparison Test: Tukey HSD \n##       resp groups\n## E1 199.538      a\n## E2  70.500      b\n## \n## \n## \n## -----------------------------------------------------------------\n## Isolated factors 2 not significant\n## -----------------------------------------------------------------\n##       Mean\n## D 140.3194\n## M 129.7185\nng_epo &lt;- \n  ng$graph1 +\n  labs(x = \"Época de semeadura\",\n       y = \"Número de grãos por planta\")\n\n# numero de graos\nrgpla &lt;- with(df, FAT2DBC(epoca, cultivar, bloco, rgpla))\n## \n## -----------------------------------------------------------------\n## Normality of errors\n## -----------------------------------------------------------------\n##                          Method Statistic   p.value\n##  Shapiro-Wilk normality test(W) 0.9053172 0.1857438\n## \n## \n## -----------------------------------------------------------------\n## Homogeneity of Variances\n## -----------------------------------------------------------------\n##                               Method Statistic   p.value\n##  Bartlett test(Bartlett's K-squared) 0.7654253 0.8577177\n## \n## \n## -----------------------------------------------------------------\n## Independence from errors\n## -----------------------------------------------------------------\n##                  Method Statistic   p.value\n##  Durbin-Watson test(DW)  2.697451 0.6722004\n## \n## \n## -----------------------------------------------------------------\n## Additional Information\n## -----------------------------------------------------------------\n## \n## CV (%) =  15.56\n## Mean =  0.7121\n## Median =  0.643\n## Possible outliers =  No discrepant point\n## \n## -----------------------------------------------------------------\n## Analysis of Variance\n## -----------------------------------------------------------------\n##           Df       Sum Sq      Mean.Sq      F value        Pr(F)\n## F1         1 2.3536099794 2.3536099794 191.73260525 8.832298e-06\n## F2         1 0.0187230000 0.0187230000   1.52523553 2.629944e-01\n## Block      2 0.0939862654 0.0469931327   3.82821106 8.480920e-02\n## F1 × F2    1 0.0003654486 0.0003654486   0.02977061 8.686848e-01\n## Residuals  6 0.0736528868 0.0122754811                          \n## \n## -----------------------------------------------------------------\n## No significant interaction\n## -----------------------------------------------------------------\n## \n## -----------------------------------------------------------------\n## F1\n## -----------------------------------------------------------------\n## Multiple Comparison Test: Tukey HSD \n##         resp groups\n## E1 1.1549815      a\n## E2 0.2692407      b\n## \n## \n## \n## -----------------------------------------------------------------\n## Isolated factors 2 not significant\n## -----------------------------------------------------------------\n##        Mean\n## D 0.7516111\n## M 0.6726111\nrgpla_epo &lt;- \n  rgpla$graph1 +\n  labs(x = \"Época de semeadura\",\n       y = \"Rendimento de grãos por planta (g)\")\n\n# numero de graos\nmmg &lt;- with(df, FAT2DBC(epoca, cultivar, bloco, mmg))\n## \n## -----------------------------------------------------------------\n## Normality of errors\n## -----------------------------------------------------------------\n##                          Method Statistic   p.value\n##  Shapiro-Wilk normality test(W) 0.9153679 0.2498259\n## \n## \n## -----------------------------------------------------------------\n## Homogeneity of Variances\n## -----------------------------------------------------------------\n##                               Method Statistic   p.value\n##  Bartlett test(Bartlett's K-squared)  6.442531 0.0919567\n## \n## \n## -----------------------------------------------------------------\n## Independence from errors\n## -----------------------------------------------------------------\n##                  Method Statistic   p.value\n##  Durbin-Watson test(DW)  3.288259 0.9580794\n## \n## \n## -----------------------------------------------------------------\n## Additional Information\n## -----------------------------------------------------------------\n## \n## CV (%) =  10.23\n## Mean =  4.8209\n## Median =  4.9657\n## Possible outliers =  No discrepant point\n## \n## -----------------------------------------------------------------\n## Analysis of Variance\n## -----------------------------------------------------------------\n##           Df       Sum Sq      Mean.Sq      F value       Pr(F)\n## F1         1 10.211317880 10.211317880 42.016690407 0.000640633\n## F2         1  0.053108614  0.053108614  0.218526956 0.656660062\n## Block      2  0.716501433  0.358250717  1.474100564 0.301471693\n## F1 × F2    1  0.001382515  0.001382515  0.005688659 0.942329919\n## Residuals  6  1.458180230  0.243030038                         \n## \n## -----------------------------------------------------------------\n## No significant interaction\n## -----------------------------------------------------------------\n## \n## -----------------------------------------------------------------\n## F1\n## -----------------------------------------------------------------\n## Multiple Comparison Test: Tukey HSD \n##        resp groups\n## E1 5.743322      a\n## E2 3.898390      b\n## \n## \n## \n## -----------------------------------------------------------------\n## Isolated factors 2 not significant\n## -----------------------------------------------------------------\n##       Mean\n## D 4.754330\n## M 4.887382\nmmg_epo &lt;- \n  mmg$graph1 +\n  labs(x = \"Época de semeadura\",\n       y = \"Massa de mil grãos (g)\")\n\n# Fenólicos totais\nFt &lt;- with(df, FAT2DBC(epoca, cultivar, bloco, Ft))\n## \n## -----------------------------------------------------------------\n## Normality of errors\n## -----------------------------------------------------------------\n##                          Method Statistic   p.value\n##  Shapiro-Wilk normality test(W) 0.9382047 0.4751702\n## \n## \n## -----------------------------------------------------------------\n## Homogeneity of Variances\n## -----------------------------------------------------------------\n##                               Method Statistic   p.value\n##  Bartlett test(Bartlett's K-squared)  2.364701 0.5002393\n## \n## \n## -----------------------------------------------------------------\n## Independence from errors\n## -----------------------------------------------------------------\n##                  Method Statistic   p.value\n##  Durbin-Watson test(DW)  2.070578 0.2838458\n## \n## \n## -----------------------------------------------------------------\n## Additional Information\n## -----------------------------------------------------------------\n## \n## CV (%) =  1.6\n## Mean =  0.8783\n## Median =  0.861\n## Possible outliers =  No discrepant point\n## \n## -----------------------------------------------------------------\n## Analysis of Variance\n## -----------------------------------------------------------------\n##           Df       Sum Sq      Mean.Sq     F value        Pr(F)\n## F1         1 0.1607836370 1.607836e-01 813.5829370 1.229478e-07\n## F2         1 0.0057402110 5.740211e-03  29.0461007 1.680570e-03\n## Block      2 0.0001933668 9.668342e-05   0.4892288 6.355876e-01\n## F1 × F2    1 0.0014081040 1.408104e-03   7.1251615 3.706118e-02\n## Residuals  6 0.0011857449 1.976242e-04                         \n## \n## -----------------------------------------------------------------\n## \n## Significant interaction: analyzing the interaction\n## \n## -----------------------------------------------------------------\n## \n## -----------------------------------------------------------------\n## Analyzing  F1  inside of each level of  F2\n## -----------------------------------------------------------------\n##              Df   Sum Sq  Mean Sq  F value    Pr(&gt;F)    \n## Block         2 0.000193 0.000097   0.4892  0.635588    \n## F2            1 0.005740 0.005740  29.0461  0.001681 ** \n## F1 × F2 + F1  2 0.162192 0.081096 410.3540 3.823e-07 ***\n##    F1:F2 D    1 0.066049 0.066049 334.2166 1.726e-06 ***\n##    F1:F2 M    1 0.096142 0.096142 486.4915 5.677e-07 ***\n## Residuals     6 0.001186 0.000198                       \n## ---\n## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n## \n## -----------------------------------------------------------------\n## Analyzing  F2  inside of the level of  F1\n## -----------------------------------------------------------------\n## \n##              Df   Sum Sq  Mean Sq  F value    Pr(&gt;F)    \n## Block         2 0.000193 0.000097   0.4892  0.635588    \n## F1            1 0.160784 0.160784 813.5829 1.229e-07 ***\n## F1 × F2 + F2  2 0.007148 0.003574  18.0856  0.002880 ** \n##    F2:F1 E1   1 0.006417 0.006417  32.4717  0.001262 ** \n##    F2:F1 E2   1 0.000731 0.000731   3.6996  0.102776    \n## Residuals     6 0.001186 0.000198                       \n## ---\n## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n\n\n## \n## -----------------------------------------------------------------\n## Final table\n## -----------------------------------------------------------------\n##           D        M\n## E1 0.961 aB 1.027 aA\n## E2 0.751 bA 0.774 bA\nFt_it &lt;- \n  Ft[[2]] +\n  labs(x = \"Época de semeadura\",\n       y = \"Fenólicos totais (µg EAG / g MS)\")\n\n# Flavonoides\nFl &lt;- with(df, FAT2DBC(epoca, cultivar, bloco, Fl))\n## \n## -----------------------------------------------------------------\n## Normality of errors\n## -----------------------------------------------------------------\n##                          Method Statistic   p.value\n##  Shapiro-Wilk normality test(W)  0.899963 0.1584451\n## \n## \n## -----------------------------------------------------------------\n## Homogeneity of Variances\n## -----------------------------------------------------------------\n##                               Method Statistic   p.value\n##  Bartlett test(Bartlett's K-squared) 0.8340391 0.8413092\n## \n## \n## -----------------------------------------------------------------\n## Independence from errors\n## -----------------------------------------------------------------\n##                  Method Statistic   p.value\n##  Durbin-Watson test(DW)  2.163419 0.3392366\n## \n## \n## -----------------------------------------------------------------\n## Additional Information\n## -----------------------------------------------------------------\n## \n## CV (%) =  1.65\n## Mean =  0.0502\n## Median =  0.0505\n## Possible outliers =  No discrepant point\n## \n## -----------------------------------------------------------------\n## Analysis of Variance\n## -----------------------------------------------------------------\n##           Df       Sum Sq      Mean.Sq     F value        Pr(F)\n## F1         1 1.477563e-03 1.477563e-03 2147.797772 6.763060e-09\n## F2         1 6.277347e-06 6.277347e-06    9.124802 2.337516e-02\n## Block      2 1.410447e-05 7.052234e-06   10.251185 1.160378e-02\n## F1 × F2    1 5.144295e-04 5.144295e-04  747.778825 1.580784e-07\n## Residuals  6 4.127660e-06 6.879434e-07                         \n## \n## -----------------------------------------------------------------\n## \n## Significant interaction: analyzing the interaction\n## \n## -----------------------------------------------------------------\n## \n## -----------------------------------------------------------------\n## Analyzing  F1  inside of each level of  F2\n## -----------------------------------------------------------------\n##              Df     Sum Sq    Mean Sq   F value    Pr(&gt;F)    \n## Block         2 0.00001410 0.00000705   10.2512   0.01160 *  \n## F2            1 0.00000628 0.00000628    9.1248   0.02338 *  \n## F1 × F2 + F1  2 0.00199199 0.00099600 1447.7883 8.842e-09 ***\n##    F1:F2 D    1 0.00012416 0.00012416  180.4771 1.054e-05 ***\n##    F1:F2 M    1 0.00186783 0.00186783 2715.0995 3.353e-09 ***\n## Residuals     6 0.00000413 0.00000069                        \n## ---\n## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n## \n## -----------------------------------------------------------------\n## Analyzing  F2  inside of the level of  F1\n## -----------------------------------------------------------------\n## \n##              Df     Sum Sq    Mean Sq  F value    Pr(&gt;F)    \n## Block         2 0.00001410 0.00000705   10.251    0.0116 *  \n## F1            1 0.00147756 0.00147756 2147.798 6.763e-09 ***\n## F1 × F2 + F2  2 0.00052071 0.00026035  378.452 4.865e-07 ***\n##    F2:F1 E1   1 0.00020353 0.00020353  295.848 2.473e-06 ***\n##    F2:F1 E2   1 0.00031718 0.00031718  461.055 6.657e-07 ***\n## Residuals     6 0.00000413 0.00000069                       \n## ---\n## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n\n\n## \n## -----------------------------------------------------------------\n## Final table\n## -----------------------------------------------------------------\n##            D         M\n## E1 0.0555 aB 0.0671 aA\n## E2 0.0464 bA 0.0318 bB\nFl_it &lt;- \n  Ft[[2]] +\n  labs(x = \"Época de semeadura\",\n       y = \"Flavonoies\")\n\n# Potencial antioxidante\nDPPH &lt;- with(df, FAT2DBC(epoca, cultivar, bloco, DPPH))\n## \n## -----------------------------------------------------------------\n## Normality of errors\n## -----------------------------------------------------------------\n##                          Method Statistic   p.value\n##  Shapiro-Wilk normality test(W) 0.9648859 0.8506053\n## \n## \n## -----------------------------------------------------------------\n## Homogeneity of Variances\n## -----------------------------------------------------------------\n##                               Method Statistic    p.value\n##  Bartlett test(Bartlett's K-squared)  6.960502 0.07316741\n## \n## \n## -----------------------------------------------------------------\n## Independence from errors\n## -----------------------------------------------------------------\n##                  Method Statistic    p.value\n##  Durbin-Watson test(DW)  1.365226 0.01493006\n## \n## \n## -----------------------------------------------------------------\n## Additional Information\n## -----------------------------------------------------------------\n## \n## CV (%) =  1.05\n## Mean =  70.892\n## Median =  69.8063\n## Possible outliers =  No discrepant point\n## \n## -----------------------------------------------------------------\n## Analysis of Variance\n## -----------------------------------------------------------------\n##           Df     Sum Sq    Mean.Sq    F value        Pr(F)\n## F1         1 248.224972 248.224972 444.907406 7.399813e-07\n## F2         1  27.937579  27.937579  50.074074 3.992677e-04\n## Block      2   7.521656   3.760828   6.740741 2.921378e-02\n## F1 × F2    1  14.144432  14.144432  25.351852 2.368401e-03\n## Residuals  6   3.347550   0.557925                        \n## \n## -----------------------------------------------------------------\n## \n## Significant interaction: analyzing the interaction\n## \n## -----------------------------------------------------------------\n## \n## -----------------------------------------------------------------\n## Analyzing  F1  inside of each level of  F2\n## -----------------------------------------------------------------\n##              Df  Sum Sq Mean Sq  F value    Pr(&gt;F)    \n## Block         2   7.522   3.761   6.7407 0.0292138 *  \n## F2            1  27.938  27.938  50.0741 0.0003993 ***\n## F1 × F2 + F1  2 262.369 131.185 235.1296 2.000e-06 ***\n##    F1:F2 D    1  71.931  71.931 128.9259 2.795e-05 ***\n##    F1:F2 M    1 190.438 190.438 341.3333 1.621e-06 ***\n## Residuals     6   3.348   0.558                       \n## ---\n## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n## \n## -----------------------------------------------------------------\n## Analyzing  F2  inside of the level of  F1\n## -----------------------------------------------------------------\n## \n##              Df  Sum Sq Mean Sq  F value    Pr(&gt;F)    \n## Block         2   7.522   3.761   6.7407 0.0292138 *  \n## F1            1 248.225 248.225 444.9074   7.4e-07 ***\n## F1 × F2 + F2  2  42.082  21.041  37.7130 0.0004001 ***\n##    F2:F1 E1   1  40.920  40.920  73.3426 0.0001392 ***\n##    F2:F1 E2   1   1.162   1.162   2.0833 0.1990215    \n## Residuals     6   3.348   0.558                       \n## ---\n## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n\n\n## \n## -----------------------------------------------------------------\n## Final table\n## -----------------------------------------------------------------\n##          D       M\n## E1 72.8 aB 78.1 aA\n## E2 65.9 bA 66.8 bA\nDPPH_it &lt;- \n  Ft[[2]] +\n  labs(x = \"Época de semeadura\",\n       y = \"DPPH\")\n\n\n5 PCA\n\ndfpca &lt;- \ndf |&gt; \n  select(epoca, ng, rgpla, mmg, Ft, Fl, DPPH, Lip, C20_3n6, C20_11n9, C18_3n6, C18_2n6t, C17_0)\nlibrary(FactoMineR)\nlibrary(factoextra)\n\npca &lt;- PCA(dfpca, quali.sup = 1)\n\n\n\n\n\n\nfviz_pca_biplot(pca, \n                habillage = 1,\n                repel = TRUE) +\n  labs(color = \"Época\",\n       shape = \"Época\")\n\n\n\n\nggsave(\"figs/pca_qualiprod.jpg\",\n       width = 6,\n       height = 6)\n\n\n6 Section info\n\nsessionInfo()\n## R version 4.3.3 (2024-02-29 ucrt)\n## Platform: x86_64-w64-mingw32/x64 (64-bit)\n## Running under: Windows 11 x64 (build 22631)\n## \n## Matrix products: default\n## \n## \n## locale:\n## [1] LC_COLLATE=Portuguese_Brazil.utf8  LC_CTYPE=Portuguese_Brazil.utf8   \n## [3] LC_MONETARY=Portuguese_Brazil.utf8 LC_NUMERIC=C                      \n## [5] LC_TIME=Portuguese_Brazil.utf8    \n## \n## time zone: America/Sao_Paulo\n## tzcode source: internal\n## \n## attached base packages:\n## [1] stats     graphics  grDevices utils     datasets  methods   base     \n## \n## other attached packages:\n##  [1] FactoMineR_2.11  metan_1.18.0     AgroR_1.3.6      factoextra_1.0.7\n##  [5] lubridate_1.9.3  forcats_1.0.0    stringr_1.5.1    dplyr_1.1.4     \n##  [9] purrr_1.0.2      readr_2.1.5      tidyr_1.3.1      tibble_3.2.1    \n## [13] ggplot2_3.5.0    tidyverse_2.0.0  rio_1.0.1       \n## \n## loaded via a namespace (and not attached):\n##   [1] dunn.test_1.3.6      gridExtra_2.3        sandwich_3.1-0      \n##   [4] readxl_1.4.3         rlang_1.1.3          magrittr_2.0.3      \n##   [7] multcomp_1.4-25      compiler_4.3.3       systemfonts_1.0.6   \n##  [10] vctrs_0.6.5          pkgconfig_2.0.3      crayon_1.5.2        \n##  [13] fastmap_1.1.1        backports_1.4.1      labeling_0.4.3      \n##  [16] utf8_1.2.4           rmarkdown_2.26       tzdb_0.4.0          \n##  [19] nloptr_2.0.3         ragg_1.3.0           xfun_0.43           \n##  [22] flashClust_1.01-2    jsonlite_1.8.8       tweenr_2.0.3        \n##  [25] broom_1.0.5          cluster_2.1.6        R6_2.5.1            \n##  [28] stringi_1.8.3        RColorBrewer_1.1-3   GGally_2.2.1        \n##  [31] car_3.1-2            boot_1.3-29          lmtest_0.9-40       \n##  [34] cellranger_1.1.0     numDeriv_2016.8-1.1  estimability_1.5    \n##  [37] Rcpp_1.0.12          knitr_1.46           zoo_1.8-12          \n##  [40] R.utils_2.12.3       Matrix_1.6-5         splines_4.3.3       \n##  [43] timechange_0.3.0     tidyselect_1.2.1     rstudioapi_0.16.0   \n##  [46] abind_1.4-5          yaml_2.3.8           codetools_0.2-19    \n##  [49] lattice_0.22-5       lmerTest_3.1-3       plyr_1.8.9          \n##  [52] withr_3.0.0          coda_0.19-4.1        evaluate_0.23       \n##  [55] survival_3.5-8       ggstats_0.6.0        polyclip_1.10-6     \n##  [58] ggpubr_0.6.0         pillar_1.9.0         carData_3.0-5       \n##  [61] DT_0.33              nortest_1.0-4        generics_0.1.3      \n##  [64] mathjaxr_1.6-0       hms_1.1.3            munsell_0.5.1       \n##  [67] scales_1.3.0         minqa_1.2.6          gtools_3.9.5        \n##  [70] xtable_1.8-4         leaps_3.1            glue_1.7.0          \n##  [73] scatterplot3d_0.3-44 emmeans_1.10.1       tools_4.3.3         \n##  [76] lme4_1.1-35.2        ggsignif_0.6.4       mvtnorm_1.2-4       \n##  [79] cowplot_1.1.3        grid_4.3.3           plotrix_3.8-4       \n##  [82] colorspace_2.1-0     nlme_3.1-164         patchwork_1.2.0     \n##  [85] ggforce_0.4.2        cli_3.6.1            textshaping_0.3.7   \n##  [88] fansi_1.0.6          gtable_0.3.5         rstatix_0.7.2       \n##  [91] R.methodsS3_1.8.2    digest_0.6.35        ggrepel_0.9.5       \n##  [94] TH.data_1.1-2        htmlwidgets_1.6.4    drc_3.0-1           \n##  [97] farver_2.1.1         htmltools_0.5.8      R.oo_1.26.0         \n## [100] lifecycle_1.0.4      multcompView_0.1-10  MASS_7.3-60.0.1"
  }
]